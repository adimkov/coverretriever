<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
		xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
		xmlns:cmd="clr-namespace:Microsoft.Practices.Prism.Commands" 
		xmlns:converter="clr-namespace:CoverRetriever.Converter" 
		xmlns:resources="clr-namespace:CoverRetriever.Resources" 
		xmlns:fluid="clr-namespace:FluidKit.Controls;assembly=FluidKit" 
		xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
		xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
		xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity" xmlns:prism="clr-namespace:Microsoft.Practices.Prism.Interactivity.InteractionRequest;assembly=Microsoft.Practices.Prism.Interactivity" xmlns:interaction="clr-namespace:CoverRetriever.Interaction" xmlns:view="clr-namespace:CoverRetriever.View" mc:Ignorable="d" x:Class="CoverRetriever.View.Shell"
		cmd:Loaded.Command="{Binding LoadedCommand}"
		Title="Shell" Width="800" Height="600">
	<Window.Resources>
		<converter:FolderSourceConverter x:Key="folderSourceConverter"/>
		<resources:CoverRetrieverResourcesWrapper x:Key="coverRetrieverResources"/>
		<DataTemplate x:Key="SuggestedCoverDataTemplate_Reflection">
			<Grid>
				<Grid.RowDefinitions>
					<RowDefinition Height="0.5*"/>
					<RowDefinition Height="0.5*"/>
				</Grid.RowDefinitions>
				<Border x:Name="ElementVisual"
						BorderThickness="2"
						BorderBrush="LightYellow"
						Background="Black"
						Padding="2">
					<Image Source="{Binding ThumbCoverUri}" Stretch="Uniform"/>
				</Border>
				<Rectangle OpacityMask="{StaticResource ReflectionBrush}"
						   Grid.Row="1">
					<Rectangle.Fill>
						<VisualBrush Visual="{Binding ElementName=ElementVisual}">
							<VisualBrush.RelativeTransform>
								<ScaleTransform ScaleX="1"
												ScaleY="-1"
												CenterX="0.5"
												CenterY="0.5" />
							</VisualBrush.RelativeTransform>
						</VisualBrush>
					</Rectangle.Fill>
				</Rectangle>
			</Grid>
		</DataTemplate>
	</Window.Resources>
	<i:Interaction.Triggers>
		<prism:InteractionRequestTrigger SourceObject="{Binding PreviewCoverRequest}">
			<interaction:PopupTrigerAction>
				<view:CoverPreviewWindow/>
			</interaction:PopupTrigerAction>
		</prism:InteractionRequestTrigger>
	</i:Interaction.Triggers>
	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="*" />
			<RowDefinition Height="*" />
		</Grid.RowDefinitions>
		<Grid.ColumnDefinitions>
			<ColumnDefinition Width="40*" />
			<ColumnDefinition Width="4" />
			<ColumnDefinition Width="60*" />
		</Grid.ColumnDefinitions>
		<Border x:Name="FileSystemBorder" Grid.RowSpan="2" >
			<TreeView ItemsSource="{Binding FileSystem}" 
					  cmd:SelectedItemChanged.Command="{Binding FileSystemSelectedItemChangedCommand}" 
					  cmd:SelectedItemChanged.CommandParameter="{Binding SelectedItem, RelativeSource={RelativeSource Self}}">
				<TreeView.ItemTemplate>
					<HierarchicalDataTemplate ItemsSource="{Binding Converter={StaticResource folderSourceConverter}}">
						<TextBlock Text="{Binding Name}"/>	
					</HierarchicalDataTemplate>
				</TreeView.ItemTemplate>
			</TreeView>
		</Border>
		<GridSplitter Grid.Column="1" Grid.RowSpan="2" HorizontalAlignment="Stretch"/>
		<Border x:Name="FileInfoBorder" DataContext="{Binding FileDetails}" Grid.Column="2" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
			<Grid>
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="50" />
					<ColumnDefinition Width="180" />
					<ColumnDefinition Width="30" />
					<ColumnDefinition Width="50" />
				</Grid.ColumnDefinitions>
				<Grid.RowDefinitions>
					<RowDefinition Height="25" />
					<RowDefinition Height="25" />
					<RowDefinition Height="25" />
					<RowDefinition Height="25" />
					<RowDefinition Height="*" />
				</Grid.RowDefinitions>
				<TextBlock Text="{Binding CoverRetrieverResources.TextFileDetails, Source={StaticResource coverRetrieverResources}}" Grid.ColumnSpan="4" />
				<TextBlock Text="{Binding CoverRetrieverResources.TextTrackName, Source={StaticResource coverRetrieverResources}}" Grid.Row="1"/>
				<TextBox Text="{Binding TrackName, Mode=OneWay}" IsReadOnly="True" Grid.Column="1" Grid.Row="1"/>
				<TextBlock Text="{Binding CoverRetrieverResources.TextArtist, Source={StaticResource coverRetrieverResources}}" Grid.Row="2"/>
				<TextBox Text="{Binding Artist, Mode=OneWay}" IsReadOnly="True" Grid.Column="1" Grid.Row="2"/>
				<TextBlock Text="{Binding CoverRetrieverResources.TextAlbum, Source={StaticResource coverRetrieverResources}}" Grid.Row="3"/>
				<TextBox Text="{Binding Album, Mode=OneWay}" IsReadOnly="True" Grid.Column="1" Grid.Row="3"/>
				<TextBlock Text="{Binding CoverRetrieverResources.TextYear, Source={StaticResource coverRetrieverResources}}" Grid.Column="2" Grid.Row="3"/>
				<TextBox Text="{Binding Year, Mode=OneWay}" IsReadOnly="True" Grid.Column="3" Grid.Row="3"/>
				
			</Grid>
		</Border>
		<Border x:Name="SuggestedCoversBorder" Grid.Row="1" Grid.Column="2" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
			<fluid:ElementFlow x:Name="elementFlow"
							   ItemsSource="{Binding SuggestedCovers}" 
							   ItemTemplate="{StaticResource SuggestedCoverDataTemplate_Reflection}"
							   cmd:MouseDoubleClick.Command="{Binding PreviewCoverCommand}"
							   cmd:MouseDoubleClick.CommandParameter="{Binding Path=SelectedItem, RelativeSource={RelativeSource Self}}"
							   ItemGap="0.5"
							   FrontItemGap="0"
							   PopoutDistance="1"
							   ElementHeight="700" TiltAngle="50">
				<fluid:ElementFlow.Layout>
					<fluid:CoverFlow />
				</fluid:ElementFlow.Layout>
				<fluid:ElementFlow.Camera>
				<PerspectiveCamera FieldOfView="27"
								   Position="0,0,5" 
								   LookDirection="-5.32689704113657E-06,0.0660727483790081,-0.997814808415504" />
				</fluid:ElementFlow.Camera>
			</fluid:ElementFlow>
		</Border>
	</Grid>
</Window>
